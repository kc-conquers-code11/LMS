<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.9" />
    <title>EduSync LMS - AI Notice Generator</title>

    <!-- CSS -->
    <link rel="stylesheet" href="/frontend/css/notice.css" />
    <link rel="stylesheet" href="/frontend/css/variables.css" />
    <link rel="stylesheet" href="/frontend/css/base.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        /* ====== MAIN CONTENT ====== */
        .main-content {
            padding: 8rem 2rem 2rem;
            transition: all 0.3s ease;
        }

        /* ====== NOTICE EDITOR LAYOUT ====== */
        .notice-editor {
            /* display: grid; */
            /* grid-template-columns: 1fr 1fr; */
            /* height: calc(100vh - 12rem); */
            display: flex;
            flex-direction: column-reverse;
            height: auto;
            gap: 2rem;
        }

        @media (max-width: 1024px) {
            .notice-editor {
                grid-template-columns: 1fr;
                height: auto;
            }
        }

        /* ====== NOTICE PREVIEW ====== */
        .notice-preview-container {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            height: 100%;
            overflow-y: auto;
        }

        .notice-template {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 2rem;
            min-height: 600px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .notice-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--primary-500);
        }

        .college-logo {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 0.5rem;
        }

        .college-info {
            text-align: center;
            flex: 1;
        }

        .college-info h1 {
            font-size: 1.5rem;
            color: var(--primary-700);
            margin: 0 0 0.25rem 0;
        }

        .college-info p {
            color: var(--text-light);
            margin: 0;
            font-size: 0.9rem;
        }

        .notice-body {
            margin: 2rem 0;
        }

        .notice-body h2 {
            color: var(--primary-600);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            text-align: center;
            font-size: 1.8rem;
            border-bottom: 1px solid var(--border);
        }

        .notice-content {
            line-height: 1.8;
            color: var(--text);
        }

        .notice-footer {
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
        }

        .signature-section {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .signature-line {
            text-align: center;
            min-width: 150px;
        }

        .signature-field {
            height: 1px;
            border-bottom: 1px solid #000;
            margin: 0.5rem 0 1rem 0;
            width: 150px;
        }

        .signature-name {
            font-weight: 600;
            color: var(--text);
        }

        .signature-title {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .notice-footer p {
            margin: 0.5rem 0;
            color: var(--text-light);
        }

        /* ====== NOTICE CONTROLS ====== */
        .notice-controls {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .controls-header {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .controls-header h2 {
            margin: 0;
            color: var(--text);
            font-size: 1.5rem;
        }

        /* ====== TEMPLATE SELECTION ====== */
        .template-section {
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .template-buttons {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .template-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg);
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .template-btn:hover {
            border-color: var(--primary-500);
            background: var(--primary-50);
        }

        .template-btn.active {
            border-color: var(--primary-500);
            background: var(--primary-500);
            color: white;
        }

        /* ====== NOTICE FORM ====== */
        .notice-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            flex: 1;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-label {
            font-weight: 600;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-input,
        .form-textarea {
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg);
            color: var(--text);
            font-family: inherit;
            resize: vertical;
        }

        .form-input:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            flex: 1;
        }

        /* ====== FORMATTING TOOLBAR ====== */
        .formatting-toolbar {
            display: flex;
            gap: 0.5rem;
            padding: 0.75rem;
            background: var(--bg-hover);
            border-radius: 6px;
            margin-bottom: 0.5rem;
            flex-wrap: wrap;
        }

        .format-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--bg);
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .format-btn:hover {
            border-color: var(--primary-500);
            background: var(--primary-50);
            color: var(--primary-500);
        }

        /* ====== ACTION BUTTONS ====== */
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
        }

        .btn-primary,
        .btn-secondary {
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-primary {
            background: linear-gradient(to right, var(--primary-500), var(--secondary-500));
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        /* ====== NOTICE OPTIONS ====== */
        .notice-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .option-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .option-select {
            padding: 0.5rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg);
            color: var(--text);
            font-family: inherit;
        }

        /* ====== SIGNATURE MANAGEMENT ====== */
        .signature-management {
            background: var(--bg-hover);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .signature-list {
            margin: 0.5rem 0;
        }

        .signature-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            border-bottom: 1px solid var(--border);
        }

        .signature-item:last-child {
            border-bottom: none;
        }

        .signature-actions {
            display: flex;
            gap: 0.5rem;
        }

        .signature-btn {
            padding: 0.25rem 0.5rem;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--bg);
            color: var(--text);
            cursor: pointer;
            font-size: 0.8rem;
        }

        .signature-btn:hover {
            background: var(--primary-50);
        }

        /* ====== AI SUGGESTIONS ====== */
        .ai-suggestions {
            background: var(--primary-50);
            border: 1px solid var(--primary-200);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .suggestion-title {
            font-weight: 600;
            color: var(--primary-700);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .suggestion-text {
            color: var(--primary-800);
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 0.75rem;
        }

        .suggestion-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .suggestion-btn {
            padding: 0.25rem 0.75rem;
            border: 1px solid var(--primary-300);
            border-radius: 4px;
            background: white;
            color: var(--primary-600);
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .suggestion-btn:hover {
            background: var(--primary-100);
        }

        /* ====== RESPONSIVE DESIGN ====== */
        @media (max-width: 768px) {
            .main-content {
                padding: 6rem 1rem 1rem;
            }

            .notice-options {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }

            .notice-header {
                flex-direction: column;
                text-align: center;
            }

            .signature-section {
                flex-direction: column;
                align-items: center;
            }
        }

        /* ====== NOTICE STYLES ====== */
        .notice-urgent {
            border-left: 4px solid var(--error);
        }

        .notice-important {
            border-left: 4px solid var(--warning);
        }

        .notice-normal {
            border-left: 4px solid var(--primary-500);
        }

        .notice-content h3 {
            color: var(--primary-600);
            margin: 1.5rem 0 0.5rem 0;
        }

        .notice-content ul,
        .notice-content ol {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }

        .notice-content li {
            margin: 0.25rem 0;
        }

        .notice-content strong {
            color: var(--primary-700);
        }
    </style>
</head>

<body>
    <div class="app-container">
        <!-- Sidebar Component -->
        <app-sidebar></app-sidebar>

        <!-- Header Component -->
        <app-header></app-header>

        <!-- Main Content -->
        <div class="main-content">
            <div class="notice-editor">
                <!-- Notice Preview -->
                <div class="notice-preview-container">
                    <div class="notice-template notice-normal" id="notice-preview">
                        <div class="notice-header">
                            <img src="/frontend/assets/logo.png" alt="College Logo" class="college-logo" onerror="this.src='https://via.placeholder.com/80x80?text=College+Logo'">
                            <div class="college-info">
                                <h1>ABC College of Engineering</h1>
                                <p>Affiliated to XYZ University | NAAC Accredited</p>
                            </div>
                        </div>

                        <div class="notice-body">
                            <h2 id="notice-title">[Notice Title]</h2>
                            <div class="notice-content" id="notice-content">
                                <p>[Notice content will appear here...]</p>
                            </div>
                        </div>

                        <div class="notice-footer">
                            <p>Date: <span id="notice-date"></span></p>
                            <div class="signature-section" id="signature-container">
                                <!-- Signatures will be added here -->
                            </div>
                            <p id="notice-department"></p>
                        </div>
                    </div>
                </div>

                <!-- Notice Controls -->
                <div class="notice-controls">
                    <div class="controls-header">
                        <h2><i class="fas fa-edit"></i> Notice Generator</h2>
                    </div>

                    <!-- Template Selection -->
                    <div class="template-section">
                        <div class="section-title">
                            <i class="fas fa-palette"></i>
                            <span>Notice Type</span>
                        </div>
                        <div class="template-buttons">
                            <button class="template-btn active" data-type="normal">Normal</button>
                            <button class="template-btn" data-type="important">Important</button>
                            <button class="template-btn" data-type="urgent">Urgent</button>
                            <button class="template-btn" data-type="exam">Exam Notice</button>
                            <button class="template-btn" data-type="event">Event Notice</button>
                        </div>
                    </div>

                    <!-- Notice Options -->
                    <div class="notice-options">
                        <div class="option-group">
                            <label class="form-label">Department</label>
                            <select class="option-select" id="notice-department-select">
                                <option value="">All Departments</option>
                                <option value="Computer Engineering">Computer Engineering</option>
                                <option value="Information Technology">Information Technology</option>
                                <option value="Artificial Intelligence & ML">Artificial Intelligence & ML</option>
                                <option value="Electronics & Computer Science">Electronics & Computer Science</option>
                                <option value="Mechatronics">Mechatronics</option>
                            </select>
                        </div>
                        <div class="option-group">
                            <label class="form-label">Priority</label>
                            <select class="option-select" id="notice-priority-select">
                                <option value="normal">Normal</option>
                                <option value="important">Important</option>
                                <option value="urgent">Urgent</option>
                            </select>
                        </div>
                    </div>

                    <!-- Signature Management -->
                    <div class="signature-management">
                        <div class="section-title">
                            <i class="fas fa-signature"></i>
                            <span>Signatures</span>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-input" id="signature-name" placeholder="Name">
                            <input type="text" class="form-input" id="signature-title" placeholder="Title/Position">
                            <button class="btn-secondary" onclick="addSignature()">
                                <i class="fas fa-plus"></i> Add Signature
                            </button>
                        </div>
                        <div class="signature-list" id="signature-list">
                            <!-- Signature items will be added here -->
                        </div>
                    </div>

                    <!-- Notice Form -->
                    <div class="notice-form">
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-heading"></i>
                                <span>Notice Title</span>
                            </label>
                            <input type="text" class="form-input" id="input-title" placeholder="Enter Notice Title">
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-align-left"></i>
                                <span>Notice Content</span>
                            </label>
                            <div class="formatting-toolbar">
                                <button class="format-btn" data-format="bold" title="Bold"><i class="fas fa-bold"></i></button>
                                <button class="format-btn" data-format="italic" title="Italic"><i class="fas fa-italic"></i></button>
                                <button class="format-btn" data-format="underline" title="Underline"><i class="fas fa-underline"></i></button>
                                <button class="format-btn" data-format="ul" title="Bullet List"><i class="fas fa-list-ul"></i></button>
                                <button class="format-btn" data-format="ol" title="Numbered List"><i class="fas fa-list-ol"></i></button>
                                <button class="format-btn" data-format="link" title="Add Link"><i class="fas fa-link"></i></button>
                            </div>
                            <textarea class="form-textarea" id="input-content" placeholder="Enter Notice Content..."></textarea>
                        </div>

                        <!-- AI Suggestions -->
                        <div class="ai-suggestions" id="ai-suggestions" style="display: none;">
                            <div class="suggestion-title">
                                <i class="fas fa-robot"></i>
                                <span>AI Suggestions</span>
                            </div>
                            <div class="suggestion-text" id="suggestion-text"></div>
                            <div class="suggestion-buttons">
                                <button class="suggestion-btn" onclick="applySuggestion()">Apply Suggestion</button>
                                <button class="suggestion-btn" onclick="regenerateSuggestion()">Regenerate</button>
                                <button class="suggestion-btn" onclick="hideSuggestion()">Dismiss</button>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="action-buttons">
                            <button class="btn-primary" onclick="generateNotice()">
                                <i class="fas fa-magic"></i> Generate Notice
                            </button>
                            <button class="btn-secondary" onclick="downloadNotice()">
                                <i class="fas fa-download"></i> Download as PDF
                            </button>
                            <button class="btn-secondary" onclick="printNotice()">
                                <i class="fas fa-print"></i> Print Notice
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer Component -->
        <!-- <app-footer></app-footer> -->
    </div>

    <!-- JavaScript -->
    <script src="../js/script.js"></script>
    <script type="module" src="../components/header/header.js"></script>
    <script type="module" src="../components/sidebar/sidebar.js"></script>
    <script type="module" src="../components/footer/footer.js"></script>

    <!-- jsPDF library for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- Notice Generator JavaScript -->
    <script>
        // Initialize the notice generator
        document.addEventListener('DOMContentLoaded', function() {
            initNoticeGenerator();
        });

        // Current notice state
        let currentNotice = {
            title: '',
            content: '',
            type: 'normal',
            department: '',
            priority: 'normal',
            date: new Date(),
            signatures: []
        };

        // AI suggestions data
        const aiSuggestions = {
            exam: [
                "Please ensure all students bring their hall tickets and college ID cards.",
                "Electronic devices are strictly prohibited in the examination hall.",
                "Results will be declared within 15 working days after the examination."
            ],
            event: [
                "All participants must register before the deadline to secure their spot.",
                "Certificates will be provided to all attendees and participants.",
                "For any queries, please contact the event coordinator."
            ],
            important: [
                "This notice requires immediate attention and compliance from all concerned.",
                "Failure to adhere to these guidelines may result in disciplinary action.",
                "Please acknowledge receipt of this notice by replying to the sender."
            ],
            urgent: [
                "This is an urgent notice that requires immediate action.",
                "Please respond within the specified timeframe to avoid consequences.",
                "Direct all urgent queries to the concerned department head."
            ],
            normal: [
                "Please make note of this information for your reference.",
                "We appreciate your cooperation and understanding in this matter.",
                "For further details, please refer to the attached document or contact us."
            ]
        };

        // Initialize the notice generator
        function initNoticeGenerator() {
            // Set current date
            const dateElement = document.getElementById('notice-date');
            const now = new Date();
            dateElement.textContent = now.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            // Set up template buttons
            document.querySelectorAll('.template-btn').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.template-btn').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    changeNoticeType(this.dataset.type);
                });
            });

            // Set up department select
            document.getElementById('notice-department-select').addEventListener('change', function() {
                currentNotice.department = this.value;
                updateDepartmentDisplay();
            });

            // Set up priority select
            document.getElementById('notice-priority-select').addEventListener('change', function() {
                currentNotice.priority = this.value;
                updateNoticeStyle();
            });

            // Set up formatting buttons
            document.querySelectorAll('.format-btn').forEach(button => {
                button.addEventListener('click', function() {
                    applyFormatting(this.dataset.format);
                });
            });

            // Set up input listeners
            document.getElementById('input-title').addEventListener('input', function() {
                currentNotice.title = this.value;
                updateNoticePreview();
            });

            document.getElementById('input-content').addEventListener('input', function() {
                currentNotice.content = this.value;
                updateNoticePreview();
            });

            // Set up auto-save
            setInterval(saveNoticeDraft, 30000); // Auto-save every 30 seconds

            // Load draft if exists
            loadNoticeDraft();
        }

        // Add signature
        function addSignature() {
            const name = document.getElementById('signature-name').value;
            const title = document.getElementById('signature-title').value;
            
            if (!name.trim()) {
                alert('Please enter a name for the signature');
                return;
            }
            
            const signature = {
                id: Date.now(),
                name: name,
                title: title
            };
            
            currentNotice.signatures.push(signature);
            updateSignatureList();
            updateSignatureDisplay();
            
            // Clear input fields
            document.getElementById('signature-name').value = '';
            document.getElementById('signature-title').value = '';
        }

        // Remove signature
        function removeSignature(id) {
            currentNotice.signatures = currentNotice.signatures.filter(sig => sig.id !== id);
            updateSignatureList();
            updateSignatureDisplay();
        }

        // Update signature list
        function updateSignatureList() {
            const list = document.getElementById('signature-list');
            list.innerHTML = '';
            
            currentNotice.signatures.forEach(signature => {
                const item = document.createElement('div');
                item.className = 'signature-item';
                item.innerHTML = `
                    <div>
                        <strong>${signature.name}</strong>
                        ${signature.title ? `<br><small>${signature.title}</small>` : ''}
                    </div>
                    <div class="signature-actions">
                        <button class="signature-btn" onclick="removeSignature(${signature.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        // Update signature display in preview
        function updateSignatureDisplay() {
            const container = document.getElementById('signature-container');
            container.innerHTML = '';
            
            currentNotice.signatures.forEach(signature => {
                const signatureLine = document.createElement('div');
                signatureLine.className = 'signature-line';
                signatureLine.innerHTML = `
                    <div class="signature-field"></div>
                    <div class="signature-name">${signature.name}</div>
                    ${signature.title ? `<div class="signature-title">${signature.title}</div>` : ''}
                `;
                container.appendChild(signatureLine);
            });
        }

        // Change notice type
        function changeNoticeType(type) {
            currentNotice.type = type;
            updateNoticeStyle();
            generateAISuggestion();
        }

        // Update notice style based on type and priority
        function updateNoticeStyle() {
            const preview = document.getElementById('notice-preview');
            preview.className = 'notice-template';
            
            // Apply priority-based styling
            preview.classList.add(`notice-${currentNotice.priority}`);
            
            // Update based on type
            switch(currentNotice.type) {
                case 'exam':
                    preview.style.borderLeft = '4px solid var(--error)';
                    break;
                case 'important':
                    preview.style.borderLeft = '4px solid var(--warning)';
                    break;
                case 'urgent':
                    preview.style.borderLeft = '4px solid var(--error)';
                    break;
                case 'event':
                    preview.style.borderLeft = '4px solid var(--success)';
                    break;
                default:
                    preview.style.borderLeft = '4px solid var(--primary-500)';
            }
        }

        // Update department display
        function updateDepartmentDisplay() {
            const departmentElement = document.getElementById('notice-department');
            if (currentNotice.department) {
                departmentElement.textContent = currentNotice.department + ' Department';
            } else {
                departmentElement.textContent = '';
            }
        }

        // Apply formatting to text
        function applyFormatting(format) {
            const textarea = document.getElementById('input-content');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            let formattedText = '';

            switch(format) {
                case 'bold':
                    formattedText = `**${selectedText}**`;
                    break;
                case 'italic':
                    formattedText = `_${selectedText}_`;
                    break;
                case 'underline':
                    formattedText = `__${selectedText}__`;
                    break;
                case 'ul':
                    formattedText = selectedText ? `- ${selectedText}` : '- ';
                    break;
                case 'ol':
                    formattedText = selectedText ? `1. ${selectedText}` : '1. ';
                    break;
                case 'link':
                    formattedText = selectedText ? `[${selectedText}](url)` : '[link text](url)';
                    break;
            }

            textarea.value = textarea.value.substring(0, start) + formattedText + textarea.value.substring(end);
            textarea.focus();
            textarea.setSelectionRange(start + formattedText.length, start + formattedText.length);
            
            // Update content
            currentNotice.content = textarea.value;
            updateNoticePreview();
        }

        // Generate AI suggestion
        function generateAISuggestion() {
            const suggestions = aiSuggestions[currentNotice.type] || aiSuggestions.normal;
            const randomSuggestion = suggestions[Math.floor(Math.random() * suggestions.length)];
            
            document.getElementById('suggestion-text').textContent = randomSuggestion;
            document.getElementById('ai-suggestions').style.display = 'block';
        }

        // Apply AI suggestion
        function applySuggestion() {
            const suggestion = document.getElementById('suggestion-text').textContent;
            const textarea = document.getElementById('input-content');
            
            if (textarea.value) {
                textarea.value += '\n\n' + suggestion;
            } else {
                textarea.value = suggestion;
            }
            
            currentNotice.content = textarea.value;
            updateNoticePreview();
            hideSuggestion();
        }

        // Regenerate AI suggestion
        function regenerateSuggestion() {
            generateAISuggestion();
        }

        // Hide AI suggestion
        function hideSuggestion() {
            document.getElementById('ai-suggestions').style.display = 'none';
        }

        // Update notice preview
        function updateNoticePreview() {
            // Update title
            document.getElementById('notice-title').textContent = currentNotice.title || '[Notice Title]';
            
            // Update content with basic markdown parsing
            let formattedContent = currentNotice.content;
            
            // Convert markdown to HTML
            formattedContent = formattedContent
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') // bold
                .replace(/_(.*?)_/g, '<em>$1</em>') // italic
                .replace(/__(.*?)__/g, '<u>$1</u>') // underline
                .replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank">$1</a>') // links
                .replace(/^- (.*$)/gm, '<li>$1</li>') // unordered list items
                .replace(/^\d+\. (.*$)/gm, '<li>$1</li>') // ordered list items
                .replace(/(<li>.*<\/li>)/gs, '<ul>$1</ul>') // wrap lists
                .replace(/\n/g, '<br>'); // line breaks
            
            document.getElementById('notice-content').innerHTML = formattedContent || '<p>[Notice content will appear here...]</p>';
        }

        // Generate notice
        function generateNotice() {
            const title = document.getElementById('input-title').value;
            const content = document.getElementById('input-content').value;
            
            if (!title.trim()) {
                alert('Please enter a notice title');
                return;
            }
            
            if (!content.trim()) {
                alert('Please enter notice content');
                return;
            }
            
            currentNotice.title = title;
            currentNotice.content = content;
            
            updateNoticePreview();
            saveNoticeDraft();
            
            // Show success message
            showNotification('Notice generated successfully!');
        }

        // Download notice as PDF
        function downloadNotice() {
            if (!currentNotice.title || !currentNotice.content) {
                alert('Please generate a notice first');
                return;
            }
            
            showNotification('Preparing PDF download...');
            
            // Use html2canvas and jsPDF to generate PDF
            const { jsPDF } = window.jspdf;
            
            html2canvas(document.getElementById('notice-preview')).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('p', 'mm', 'a4');
                const imgWidth = 210; // A4 width in mm
                const pageHeight = 295; // A4 height in mm
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Add more pages if needed
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // Save the PDF
                pdf.save(`${currentNotice.title.replace(/\s+/g, '_')}.pdf`);
                showNotification('Notice downloaded as PDF successfully!');
            });
        }

        // Print notice
        function printNotice() {
            if (!currentNotice.title || !currentNotice.content) {
                alert('Please generate a notice first');
                return;
            }
            
            const printContent = document.getElementById('notice-preview').innerHTML;
            const originalContent = document.body.innerHTML;
            
            document.body.innerHTML = printContent;
            window.print();
            document.body.innerHTML = originalContent;
            
            // Reinitialize the page
            initNoticeGenerator();
        }

        // Save notice draft
        function saveNoticeDraft() {
            const draft = {
                ...currentNotice,
                savedAt: new Date().toISOString()
            };
            localStorage.setItem('noticeDraft', JSON.stringify(draft));
        }

        // Load notice draft
        function loadNoticeDraft() {
            const draft = localStorage.getItem('noticeDraft');
            if (draft) {
                const parsedDraft = JSON.parse(draft);
                currentNotice = {...parsedDraft};
                
                // Update form fields
                document.getElementById('input-title').value = currentNotice.title;
                document.getElementById('input-content').value = currentNotice.content;
                document.getElementById('notice-department-select').value = currentNotice.department;
                document.getElementById('notice-priority-select').value = currentNotice.priority;
                
                // Update signatures
                updateSignatureList();
                updateSignatureDisplay();
                
                // Update preview
                updateNoticePreview();
                updateDepartmentDisplay();
                updateNoticeStyle();
                
                showNotification('Draft notice loaded');
            }
        }

        // Show notification
        function showNotification(message) {
            // Create a simple toast notification
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.position = 'fixed';
            toast.style.bottom = '20px';
            toast.style.right = '20px';
            toast.style.backgroundColor = 'var(--primary-500)';
            toast.style.color = 'white';
            toast.style.padding = '10px 20px';
            toast.style.borderRadius = '4px';
            toast.style.zIndex = '1000';
            toast.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
            
            document.body.appendChild(toast);
            
            // Remove toast after 3 seconds
            setTimeout(() => {
                if (document.body.contains(toast)) {
                    document.body.removeChild(toast);
                }
            }, 3000);
        }
    </script>
</body>
</html>